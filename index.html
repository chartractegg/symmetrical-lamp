<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Symmetrical Lamp â€” Retro Games (All-in-One)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --win:#c0c0c0; --light:#ffffff; --mid:#dfdfdf; --shadow:#808080; --dark:#000000;
    --felt:#2f4f2f;
  }
  *{box-sizing:border-box;}
  html,body{height:100%;}
  body{
    margin:0;
    background:var(--win);
    font:14px Tahoma, Verdana, Arial, sans-serif;
  }

  .desk{
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:10px;
  }

  .window{
    width:min(1100px, 100%);
    border:2px solid var(--dark);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light),
      4px 4px 0 rgba(0,0,0,0.4);
    background:var(--win);
    display:flex;
    flex-direction:column;
    max-height:98vh;
  }

  .titlebar{
    background:linear-gradient(90deg,#02007a,#2a7bd8);
    color:#fff;
    padding:3px 6px;
    display:flex;
    align-items:center;
    justify-content:space-between;
  }
  .titlebar span{
    font-weight:700;
  }
  .sysbtns{
    display:flex;
    gap:2px;
  }
  .sysbtn{
    width:18px; height:18px;
    border:1px solid #000;
    background:#c0c0c0;
    box-shadow:
      inset -1px -1px 0 #000,
      inset  1px  1px 0 #fff;
    font-size:11px;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .view{
    display:none;
    flex:1;
    overflow:auto;
  }

  /* ==== MENU VIEW ==== */
  #view-menu{
    display:flex;
  }
  .content{
    display:flex;
    padding:10px;
    gap:10px;
    width:100%;
  }

  .left{
    flex:1.2;
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    padding:10px;
    background:var(--mid);
  }
  h1{
    font-size:18px;
    margin:0 0 10px 0;
  }
  .ascii{
    font-family:"Courier New", monospace;
    font-size:11px;
    white-space:pre;
    background:#000;
    color:#0f0;
    padding:6px;
    margin-bottom:8px;
    border:2px inset #333;
  }

  .intro{
    background:#fff;
    border:2px inset #999;
    padding:6px 8px;
    margin-bottom:10px;
    font-size:13px;
  }

  .right{
    flex:1;
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    padding:10px;
    background:var(--mid);
    display:flex;
    flex-direction:column;
    justify-content:space-between;
  }

  ul{
    list-style:none;
    margin:0;
    padding:0;
  }
  li{
    margin-bottom:6px;
  }

  .link-btn,
  .backbtn{
    display:inline-block;
    padding:4px 10px;
    background:var(--win);
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    text-decoration:none;
    color:#000;
    font-size:13px;
    cursor:pointer;
  }
  .link-btn:active,
  .backbtn:active{
    box-shadow:
      inset -1px -1px 0 var(--light),
      inset  1px  1px 0 var(--dark);
  }

  .footer{
    margin-top:12px;
    font-size:11px;
    opacity:0.85;
  }

  .backwrap{
    margin-top:8px;
    text-align:center;
  }

  @media (max-width:840px){
    .content{ flex-direction:column; }
  }

  /* ==== SHARED CARD STYLES ==== */
  .card-row{
    display:flex;
    gap:6px;
    flex-wrap:wrap;
  }

  .card{
    width:46px; height:64px;
    border-radius:4px;
    background:#fff;
    color:#000;
    border:2px solid #000;
    box-shadow: 0 2px 0 rgba(0,0,0,0.45);
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:700;
    font-size:18px;
    font-family:"Courier New", monospace;
  }
  .card.red{
    color:#b00000;
  }
  .card.small{
    width:34px;
    height:46px;
    font-size:14px;
  }
  .card.back{
    background:repeating-linear-gradient(
      45deg,
      #003,#003 4px,
      #0af 4px,#0af 8px
    );
    color:#fff;
    border-color:#001133;
  }

  /* ==== BLACKJACK VIEW ==== */
  #view-blackjack{
    padding:10px;
  }
  .bj-layout{
    display:flex;
    flex-direction:column;
    gap:8px;
    height:100%;
  }
  .bj-table{
    flex:1;
    background:var(--felt);
    border-radius:10px;
    border:2px solid #1d321d;
    box-shadow: inset -1px -1px 0 #1d321d, inset 1px 1px 0 #000;
    padding:10px;
    color:#f0f0f0;
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .bj-row{
    display:flex;
    align-items:flex-start;
    gap:8px;
  }
  .bj-label{
    width:70px;
    font-weight:700;
  }
  .bj-hand{
    flex:1;
    display:flex;
    flex-wrap:wrap;
    gap:4px;
  }
  .bj-total{
    width:70px;
    text-align:right;
    font-weight:700;
  }

  .bj-info-line{
    display:flex;
    justify-content:space-between;
    font-size:13px;
    margin-top:4px;
  }

  .bj-controls{
    margin-top:4px;
    padding:6px;
    background:rgba(0,0,0,0.35);
    border-radius:6px;
    display:flex;
    flex-wrap:wrap;
    gap:6px;
    align-items:center;
  }
  .bj-controls label{
    font-size:13px;
  }
  .bj-controls input{
    width:80px;
    background:var(--win);
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    padding:2px 4px;
    font:13px Tahoma, Arial, sans-serif;
  }
  .bj-controls button{
    min-width:70px;
    font:13px Tahoma, Arial, sans-serif;
    padding:3px 10px;
    background:var(--win);
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    cursor:pointer;
  }
  .bj-controls button:disabled{
    opacity:0.5;
    cursor:default;
  }
  .bj-controls button:active:not(:disabled){
    box-shadow:
      inset -1px -1px 0 var(--light),
      inset  1px  1px 0 var(--dark);
  }
  .bj-message{
    margin-top:4px;
    font-size:13px;
    min-height:18px;
  }

  /* ==== HOLDEM VIEW ==== */
  #view-holdem{
    padding:10px;
  }
  .holdem-layout{
    display:flex;
    flex-direction:column;
    gap:8px;
    height:100%;
  }
  .holdem-table{
    flex:1;
    background:var(--felt);
    border-radius:10px;
    border:2px solid #1d321d;
    box-shadow: inset -1px -1px 0 #1d321d, inset 1px 1px 0 #000;
    padding:10px;
    color:#f0f0f0;
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .holdem-top{
    display:flex;
    justify-content:space-between;
    flex-wrap:wrap;
    gap:8px;
    align-items:center;
  }
  .holdem-controls{
    display:flex;
    flex-wrap:wrap;
    gap:6px;
    align-items:center;
    font-size:13px;
  }
  .holdem-controls select{
    background:var(--win);
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    padding:2px 4px;
    font:13px Tahoma, Arial, sans-serif;
  }
  .holdem-controls button{
    font:13px Tahoma, Arial, sans-serif;
    padding:3px 10px;
    background:var(--win);
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    cursor:pointer;
  }
  .holdem-controls button:active{
    box-shadow:
      inset -1px -1px 0 var(--light),
      inset  1px  1px 0 var(--dark);
  }
  .holdem-board{
    display:flex;
    gap:6px;
    align-items:center;
  }
  .holdem-status{
    font-size:13px;
    margin-top:4px;
  }
  .holdem-players{
    margin-top:6px;
    display:flex;
    flex-wrap:wrap;
    gap:6px;
  }
  .h-seat{
    flex:1 1 170px;
    max-width:210px;
    background:rgba(0,0,0,0.35);
    border-radius:6px;
    border:1px solid rgba(0,0,0,0.7);
    padding:4px 6px;
    display:flex;
    flex-direction:column;
    gap:2px;
  }
  .h-seat.you{
    border-color:#ffd700;
    box-shadow:0 0 0 2px rgba(255,215,0,0.4);
  }
  .h-head{
    display:flex;
    justify-content:space-between;
    font-size:12px;
  }
  .h-name{
    font-weight:700;
  }
  .h-tag{
    font-size:11px;
    padding:1px 5px;
    border-radius:999px;
    background:#111;
  }
  .h-tag.winner{
    background:#006400;
    color:#aaffaa;
  }
  .h-handrow{
    margin-top:2px;
    display:flex;
    flex-direction:column;
    gap:2px;
  }
  .h-cards{
    display:flex;
    gap:4px;
  }
  .h-note{
    font-size:11px;
    opacity:0.9;
  }

  /* ==== SNAKE VIEW ==== */
  #view-snake{
    padding:10px;
  }
  .snake-layout{
    display:flex;
    gap:16px;
    align-items:center;
    justify-content:center;
    width:100%;
    flex-wrap:wrap;
  }
  .snake-leaderboard{
    width:220px;
    background:#dfdfdf;
    border:2px solid #808080;
    box-shadow:
      inset -1px -1px 0 #000000,
      inset  1px  1px 0 #ffffff,
      3px 3px 0 rgba(0,0,0,0.35);
    padding:8px;
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .snake-leaderboard h2{
    font-size:14px;
    margin:0 0 4px 0;
  }
  .snake-leaderboard small{
    font-size:11px;
    opacity:0.8;
  }
  #snakeLeaderboardList{
    list-style:none;
    margin:4px 0 0 0;
    padding:0;
    font-size:12px;
    max-height:220px;
    overflow-y:auto;
    border:2px inset #b0b0b0;
    background:#ffffff;
  }
  #snakeLeaderboardList li{
    padding:2px 4px;
    border-bottom:1px solid #e0e0e0;
  }
  #snakeLeaderboardList li:last-child{
    border-bottom:none;
  }
  .snake-game-col{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:8px;
  }
  .snake-screen{
    background:#5a7751;
    border:4px solid #3a4a3a;
    box-shadow:
      inset 2px 2px 0 #7f9f7f,
      inset -2px -2px 0 #2f3f2f;
    border-radius:10px;
    width:75vw;
    max-width:420px;
    aspect-ratio:3/4;
    display:flex;
    align-items:center;
    justify-content:center;
    touch-action:manipulation;
    position:relative;
  }
  #snakeCanvas{
    background:#5a7751;
    width:95%;
    height:95%;
    display:block;
  }
  .snake-score{
    position:absolute;
    bottom:8px;
    right:10px;
    color:#e0ffe0;
    font-size:14px;
  }

  /* ==== MINESWEEPER VIEW ==== */
  #view-minesweeper{
    padding:10px;
  }
  .ms-container{
    margin:0 auto;
    background:#c0c0c0;
    padding:8px;
    border:2px solid #000000;
    box-shadow:
      inset -1px -1px 0 #808080,
      inset 1px 1px 0 #ffffff,
      inset -2px -2px 0 #000000,
      inset 2px 2px 0 #dfdfdf;
    display:inline-block;
  }
  .ms-titlebar{
    background:linear-gradient(#000080,#0000a8);
    color:#fff;
    padding:3px 6px;
    margin-bottom:6px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    font-weight:700;
    font-size:13px;
  }
  .ms-frame{
    border:2px solid #808080;
    box-shadow:
      inset -1px -1px 0 #000000,
      inset 1px 1px 0 #ffffff;
    padding:6px;
    background:#c0c0c0;
    display:inline-block;
  }
  .ms-panel{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
    margin-bottom:6px;
    padding:6px;
    border:2px solid #808080;
    box-shadow:
      inset -1px -1px 0 #000000,
      inset 1px 1px 0 #ffffff;
    background:#dfdfdf;
    font-size:12px;
  }
  .ms-display{
    width:56px;
    height:32px;
    display:grid;
    place-items:center;
    background:#6b0000;
    color:#ff1a1a;
    font:700 22px/1 "Courier New",monospace;
    border:2px solid #000000;
    box-shadow:
      inset 0 1px 0 #3d0000,
      inset 0 -1px 0 #3d0000,
      inset 1px 0 0 #3d0000,
      inset -1px 0 0 #3d0000;
    letter-spacing:1px;
  }
  .ms-btn{
    width:32px;
    height:32px;
    background:#c0c0c0;
    border:2px solid #808080;
    box-shadow:
      inset -1px -1px 0 #000000,
      inset 1px 1px 0 #ffffff;
    display:grid;
    place-items:center;
    cursor:pointer;
  }
  .ms-btn:active{
    box-shadow:
      inset -1px -1px 0 #ffffff,
      inset 1px 1px 0 #000000;
  }
  .ms-smiley{font-size:20px;}

  #msBoard{
    --rows:9;
    --cols:9;
    display:grid;
    grid-template-columns:repeat(var(--cols), 24px);
    gap:0;
    border:2px solid #808080;
    box-shadow:
      inset -1px -1px 0 #000000,
      inset 1px 1px 0 #ffffff;
    background:#c0c0c0;
  }
  #msBoard .cell{
    width:24px;
    height:24px;
    display:grid;
    place-items:center;
    background:#c0c0c0;
    cursor:pointer;
    border:2px solid #ffffff;
    box-shadow:
      inset -1px -1px 0 #808080,
      inset 1px 1px 0 #ffffff;
    font-weight:700;
    font-size:16px;
  }
  #msBoard .cell.revealed{
    background:#bdbdbd;
    border:1px solid #808080;
    box-shadow:none;
    cursor:default;
  }
  #msBoard .cell.mine.revealed{
    background:#ffcccc;
  }
  #msBoard .cell.flagged{
    color:#c01818;
  }
  #msBoard .cell.n1{color:#0000ff}
  #msBoard .cell.n2{color:#008000}
  #msBoard .cell.n3{color:#ff0000}
  #msBoard .cell.n4{color:#000080}
  #msBoard .cell.n5{color:#800000}
  #msBoard .cell.n6{color:#008080}
  #msBoard .cell.n7{color:#000000}
  #msBoard .cell.n8{color:#808080}

  .ms-status{
    margin-top:4px;
    font-size:12px;
  }

  /* ==== BACCARAT VIEW ==== */
  #view-baccarat{
    padding:10px;
  }
  .bac-layout{
    display:flex;
    flex-direction:column;
    gap:8px;
    height:100%;
  }
  .bac-table{
    flex:1;
    background:var(--felt);
    border-radius:10px;
    border:2px solid #1d321d;
    box-shadow: inset -1px -1px 0 #1d321d, inset 1px 1px 0 #000;
    padding:10px;
    color:#f0f0f0;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .bac-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
    font-size:13px;
  }
  .bac-controls{
    display:flex;
    flex-wrap:wrap;
    gap:6px;
    align-items:center;
  }
  .bac-controls input{
    width:80px;
    background:var(--win);
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    padding:2px 4px;
    font:13px Tahoma, Arial, sans-serif;
  }
  .bac-controls button{
    font:13px Tahoma, Arial, sans-serif;
    padding:3px 10px;
    background:var(--win);
    border:2px solid var(--shadow);
    box-shadow:
      inset -1px -1px 0 var(--dark),
      inset  1px  1px 0 var(--light);
    cursor:pointer;
  }
  .bac-controls button:active{
    box-shadow:
      inset -1px -1px 0 var(--light),
      inset  1px  1px 0 var(--dark);
  }
  .bac-row{
    display:flex;
    gap:8px;
    align-items:flex-start;
  }
  .bac-label{
    width:80px;
    font-weight:700;
  }
  .bac-cards{
    flex:1;
    display:flex;
    gap:4px;
    flex-wrap:wrap;
  }
  .bac-total{
    width:60px;
    text-align:right;
    font-weight:700;
  }
  .bac-msg{
    font-size:13px;
    min-height:18px;
  }

  /* ==== SOLITAIRE VIEW ==== */
  #view-solitaire{
    padding:10px;
  }
  .sol-layout{
    display:flex;
    flex-direction:column;
    gap:8px;
    height:100%;
  }
  .sol-table{
    flex:1;
    background:var(--felt);
    border-radius:10px;
    border:2px solid #1d321d;
    box-shadow: inset -1px -1px 0 #1d321d, inset 1px 1px 0 #000;
    padding:10px;
    color:#f0f0f0;
    font-size:13px;
  }
  .sol-note{
    margin-bottom:10px;
  }
  .sol-placeholder{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
  }
  .sol-pile{
    width:60px;
    height:80px;
    border-radius:6px;
    border:2px dashed rgba(255,255,255,0.4);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:11px;
    opacity:0.8;
  }
</style>
</head>
<body>
<div class="desk">
  <div class="window">
    <div class="titlebar">
      <span>Symmetrical Lamp â€” Retro Games</span>
      <div class="sysbtns">
        <div class="sysbtn">_</div>
        <div class="sysbtn">â–¡</div>
        <div class="sysbtn">Ã—</div>
      </div>
    </div>

    <!-- MENU VIEW -->
    <div class="view" id="view-menu">
      <div class="content">
        <div class="left">
          <h1>Retro Game Launcher</h1>
          <div class="ascii">
  .-=-=-=-=-=-=-=-=-=-=-=-.
  |  SYMMETRICAL   LAMP   |
  |   retro game module   |
  `-=-=-=-=-=-=-=-=-=-=-=-'
          </div>
          <div class="intro">
            <p>Welcome to your extremely serious, highly professional retro arcade.</p>
            <p>All of this now lives in a single HTML file, because the ZIP wars were getting out of hand.</p>
          </div>
          <div style="font-size:12px;">
            <p>â€¢ Blackjack &amp; Baccarat: house games.</p>
            <p>â€¢ Texas Hold'em: you vs CPUs with real hand ranking.</p>
            <p>â€¢ Snake &amp; Minesweeper: classic time-wasters.</p>
            <p>â€¢ Solitaire: layout ready, gameplay coming next.</p>
          </div>
        </div>

        <div class="right">
          <div>
            <h2 style="font-size:14px; margin:0 0 8px 0;">Games</h2>
            <ul>
              <li>
                <button class="link-btn" onclick="showView('view-blackjack')">
                  â–º Blackjack
                </button>
              </li>
              <li>
                <button class="link-btn" onclick="showView('view-baccarat')">
                  â–º Baccarat (simple)
                </button>
              </li>
              <li>
                <button class="link-btn" onclick="showView('view-holdem')">
                  â–º Texas Hold'em Poker
                </button>
              </li>
              <li>
                <button class="link-btn" onclick="showView('view-snake')">
                  â–º Snake
                </button>
              </li>
              <li>
                <button class="link-btn" onclick="showView('view-minesweeper')">
                  â–º Minesweeper
                </button>
              </li>
              <li>
                <button class="link-btn" onclick="showView('view-solitaire')">
                  â–º Solitaire (WIP)
                </button>
              </li>
            </ul>
          </div>

          <div class="footer">
            <div>Tip: use the in-game Back buttons to return here.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- BLACKJACK VIEW -->
    <div class="view" id="view-blackjack">
      <div class="bj-layout">
        <div class="bj-table">
          <div class="bj-row">
            <div class="bj-label">Dealer</div>
            <div class="bj-hand" id="bjDealerCards"></div>
            <div class="bj-total" id="bjDealerTotal"></div>
          </div>
          <div class="bj-row">
            <div class="bj-label">You</div>
            <div class="bj-hand" id="bjPlayerCards"></div>
            <div class="bj-total" id="bjPlayerTotal"></div>
          </div>

          <div class="bj-info-line">
            <div>Bank: $<span id="bjBank">1000</span></div>
            <div>Last result: <span id="bjResultText">â€”</span></div>
          </div>

          <div class="bj-controls">
            <label for="bjBet">Bet</label>
            <input id="bjBet" type="number" min="5" step="5" value="50" />
            <button id="bjDealBtn">Deal</button>
            <button id="bjHitBtn" disabled>Hit</button>
            <button id="bjStandBtn" disabled>Stand</button>
            <button id="bjDoubleBtn" disabled>Double</button>
          </div>

          <div class="bj-message" id="bjMessage"></div>
        </div>

        <div class="backwrap">
          <button class="backbtn" onclick="showView('view-menu')">âŸµ Back to Menu</button>
        </div>
      </div>
    </div>

    <!-- HOLDEM VIEW -->
    <div class="view" id="view-holdem">
      <div class="holdem-layout">
        <div class="holdem-table">
          <div class="holdem-top">
            <div class="holdem-controls">
              <span>Opponents:</span>
              <select id="hOppCount">
                <option value="1">1</option>
                <option value="2" selected>2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
              </select>
              <button id="hNewHandBtn">Deal Hand</button>
            </div>
            <div class="holdem-board" id="hBoard">
              <!-- community cards -->
            </div>
          </div>
          <div class="holdem-status" id="hStatus">Click "Deal Hand" to start.</div>
          <div class="holdem-players" id="hPlayers">
            <!-- seats -->
          </div>
        </div>

        <div class="backwrap">
          <button class="backbtn" onclick="showView('view-menu')">âŸµ Back to Menu</button>
        </div>
      </div>
    </div>

    <!-- SNAKE VIEW -->
    <div class="view" id="view-snake">
      <div class="snake-layout">
        <div class="snake-leaderboard">
          <h2>Snake High Scores</h2>
          <small>Stored in this browser only.</small>
          <ul id="snakeLeaderboardList"></ul>
        </div>
        <div class="snake-game-col">
          <div class="snake-screen" id="snakeScreen">
            <canvas id="snakeCanvas" width="240" height="320"></canvas>
            <div class="snake-score">Score: <span id="snakeScore">0</span></div>
          </div>
          <div class="backwrap">
            <button class="backbtn" onclick="showView('view-menu')">âŸµ Back to Menu</button>
          </div>
        </div>
      </div>
    </div>

    <!-- MINESWEEPER VIEW -->
    <div class="view" id="view-minesweeper">
      <div style="display:flex; flex-direction:column; align-items:center; gap:8px; padding:10px;">
        <div class="ms-container">
          <div class="ms-titlebar">
            <div>Minesweeper</div>
            <div>Â© Retro style</div>
          </div>
          <div class="ms-frame">
            <div class="ms-panel">
              <div class="ms-display" id="msMineCount">010</div>
              <div class="ms-btn" id="msReset"><span class="ms-smiley" id="msSmiley">ðŸ™‚</span></div>
              <div class="ms-display" id="msTimer">000</div>
            </div>
            <div class="ms-panel" style="justify-content:space-between;">
              <div>
                <label for="msDifficulty">Difficulty:</label>
                <select id="msDifficulty">
                  <option value="9x9x10">Beginner (9Ã—9, 10)</option>
                  <option value="16x16x40">Intermediate (16Ã—16, 40)</option>
                  <option value="16x30x99">Expert (16Ã—30, 99)</option>
                </select>
              </div>
              <div>Right-click to Flag â€¢ Double-click number to Chord</div>
            </div>
            <div id="msBoard"></div>
            <div class="ms-status" id="msStatus"></div>
          </div>
        </div>
        <div class="backwrap">
          <button class="backbtn" onclick="showView('view-menu')">âŸµ Back to Menu</button>
        </div>
      </div>
    </div>

    <!-- BACCARAT VIEW -->
    <div class="view" id="view-baccarat">
      <div class="bac-layout">
        <div class="bac-table">
          <div class="bac-header">
            <div>Bank: $<span id="bacBank">1000</span></div>
            <div class="bac-controls">
              <span>Bet:</span>
              <input id="bacBet" type="number" min="5" step="5" value="50" />
              <label><input type="radio" name="bacSide" value="player" checked> Player</label>
              <label><input type="radio" name="bacSide" value="banker"> Banker</label>
              <label><input type="radio" name="bacSide" value="tie"> Tie</label>
              <button id="bacDealBtn">Deal</button>
            </div>
          </div>
          <div class="bac-row">
            <div class="bac-label">Player</div>
            <div class="bac-cards" id="bacPlayerCards"></div>
            <div class="bac-total" id="bacPlayerTotal"></div>
          </div>
          <div class="bac-row">
            <div class="bac-label">Banker</div>
            <div class="bac-cards" id="bacBankerCards"></div>
            <div class="bac-total" id="bacBankerTotal"></div>
          </div>
          <div class="bac-msg" id="bacMessage"></div>
          <div style="font-size:11px; opacity:0.8;">
            Note: simplified Baccarat â€” two-card totals only, no third-card rules yet.
          </div>
        </div>
        <div class="backwrap">
          <button class="backbtn" onclick="showView('view-menu')">âŸµ Back to Menu</button>
        </div>
      </div>
    </div>

    <!-- SOLITAIRE VIEW -->
    <div class="view" id="view-solitaire">
      <div class="sol-layout">
        <div class="sol-table">
          <div class="sol-note">
            Solitaire layout is here; gameplay logic is next on the chopping block.  
            For now this is a visual placeholder so you can wire it into the menu cleanly.
          </div>
          <div class="sol-placeholder">
            <div class="sol-pile">Stock</div>
            <div class="sol-pile">Waste</div>
            <div class="sol-pile">Foundation 1</div>
            <div class="sol-pile">Foundation 2</div>
            <div class="sol-pile">Foundation 3</div>
            <div class="sol-pile">Foundation 4</div>
            <div class="sol-pile">Tableau 1</div>
            <div class="sol-pile">Tableau 2</div>
            <div class="sol-pile">Tableau 3</div>
            <div class="sol-pile">Tableau 4</div>
            <div class="sol-pile">Tableau 5</div>
            <div class="sol-pile">Tableau 6</div>
            <div class="sol-pile">Tableau 7</div>
          </div>
        </div>
        <div class="backwrap">
          <button class="backbtn" onclick="showView('view-menu')">âŸµ Back to Menu</button>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
/* ========= VIEW SWITCHING ========= */
function showView(id){
  document.querySelectorAll('.view').forEach(v => v.style.display = 'none');
  const el = document.getElementById(id);
  if(el){
    el.style.display = 'flex';
  }
}
showView('view-menu');

/* ========= SHARED CARD UTILITIES ========= */
const SUITS = ["â™ ","â™¥","â™¦","â™£"];
const RANKS = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];

function isRedSuit(suit){
  return suit === "â™¥" || suit === "â™¦";
}

function makeDeck(){
  const deck = [];
  for(const s of SUITS){
    for(const r of RANKS){
      deck.push({ rank:r, suit:s });
    }
  }
  return deck;
}

function shuffle(deck){
  for(let i = deck.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [deck[i], deck[j]] = [deck[j], deck[i]];
  }
}

function createCardEl(card, options){
  const el = document.createElement('div');
  const small = options && options.small;
  const faceDown = options && options.back;
  el.className = 'card' + (small ? ' small' : '');
  if(faceDown){
    el.classList.add('back');
    return el;
  }
  if(isRedSuit(card.suit)){
    el.classList.add('red');
  }
  el.textContent = card.rank + card.suit;
  return el;
}

/* ========= BLACKJACK ========= */
(function setupBlackjack(){
  const dealerRow = document.getElementById('bjDealerCards');
  const playerRow = document.getElementById('bjPlayerCards');
  const dealerTotalEl = document.getElementById('bjDealerTotal');
  const playerTotalEl = document.getElementById('bjPlayerTotal');
  const bankEl = document.getElementById('bjBank');
  const betInput = document.getElementById('bjBet');
  const dealBtn = document.getElementById('bjDealBtn');
  const hitBtn = document.getElementById('bjHitBtn');
  const standBtn = document.getElementById('bjStandBtn');
  const doubleBtn = document.getElementById('bjDoubleBtn');
  const msgEl = document.getElementById('bjMessage');
  const resultEl = document.getElementById('bjResultText');

  let deck = [];
  let bank = 1000;
  let bet = 50;
  let playerHand = [];
  let dealerHand = [];
  let inRound = false;
  let canDouble = false;

  function bjCardValue(rank){
    if(rank === "A") return 11;
    if(rank === "K" || rank === "Q" || rank === "J") return 10;
    return parseInt(rank, 10);
  }

  function bjHandTotal(hand){
    let total = 0;
    let aces = 0;
    for(const c of hand){
      const v = bjCardValue(c.rank);
      total += v;
      if(c.rank === "A") aces++;
    }
    while(total > 21 && aces > 0){
      total -= 10;
      aces--;
    }
    return total;
  }

  function ensureDeck(){
    if(deck.length < 15){
      deck = makeDeck();
      shuffle(deck);
    }
  }

  function drawCard(){
    ensureDeck();
    return deck.pop();
  }

  function setMessage(text){
    msgEl.textContent = text || '';
  }

  function setResult(text){
    resultEl.textContent = text || 'â€”';
  }

  function renderHands(revealDealer){
    dealerRow.innerHTML = '';
    playerRow.innerHTML = '';

    dealerHand.forEach((c, idx) => {
      const back = !revealDealer && idx === 1;
      dealerRow.appendChild(createCardEl(c, { back, small:false }));
    });
    playerHand.forEach(c => {
      playerRow.appendChild(createCardEl(c, { small:false }));
    });

    const pTotal = bjHandTotal(playerHand);
    const dTotal = revealDealer ? bjHandTotal(dealerHand) : (dealerHand.length ? bjCardValue(dealerHand[0].rank) : 0);

    playerTotalEl.textContent = pTotal ? pTotal : '';
    dealerTotalEl.textContent = dealerHand.length ? dTotal : '';
  }

  function updateButtons(){
    dealBtn.disabled   = inRound || bank <= 0;
    hitBtn.disabled    = !inRound;
    standBtn.disabled  = !inRound;
    doubleBtn.disabled = !inRound || !canDouble || bank < bet;
  }

  function settleNatural(){
    const pTotal = bjHandTotal(playerHand);
    const dTotal = bjHandTotal(dealerHand);
    const pBJ = (pTotal === 21 && playerHand.length === 2);
    const dBJ = (dTotal === 21 && dealerHand.length === 2);

    if(!pBJ && !dBJ) return false;

    renderHands(true);

    if(pBJ && dBJ){
      bank += bet;
      bankEl.textContent = bank;
      setResult('Push (both blackjack).');
    }else if(pBJ){
      const win = Math.floor(bet * 1.5);
      bank += bet + win;
      bankEl.textContent = bank;
      setResult(`Blackjack! You win $${win}.`);
    }else{
      setResult(`Dealer blackjack. You lose $${bet}.`);
    }

    inRound = false;
    canDouble = false;
    updateButtons();
    return true;
  }

  function endRoundNormal(){
    const pTotal = bjHandTotal(playerHand);
    const dTotal = bjHandTotal(dealerHand);

    let delta = 0;
    if(pTotal > 21){
      delta = -bet;
      setResult(`Bust. You lose $${bet}.`);
    }else if(dTotal > 21){
      delta = bet;
      setResult(`Dealer busts. You win $${bet}.`);
    }else if(pTotal > dTotal){
      delta = bet;
      setResult(`You win $${bet}.`);
    }else if(pTotal < dTotal){
      delta = -bet;
      setResult(`Dealer wins. You lose $${bet}.`);
    }else{
      bank += bet;
      bankEl.textContent = bank;
      setResult('Push.');
      inRound = false;
      canDouble = false;
      updateButtons();
      return;
    }

    if(delta > 0){
      bank += bet + delta;
    }
    bankEl.textContent = bank;
    inRound = false;
    canDouble = false;
    updateButtons();
  }

  function dealerPlay(){
    renderHands(true);
    let dTotal = bjHandTotal(dealerHand);
    while(dTotal < 17){
      dealerHand.push(drawCard());
      renderHands(true);
      dTotal = bjHandTotal(dealerHand);
    }
  }

  function startDeal(){
    setMessage('');
    setResult('â€”');
    const rawBet = parseInt(betInput.value, 10) || 0;
    if(rawBet <= 0){
      setMessage('Bet must be > 0.');
      return;
    }
    if(rawBet > bank){
      setMessage('You cannot bet more than your bank.');
      return;
    }
    bet = rawBet;
    bank -= bet;
    bankEl.textContent = bank;

    playerHand = [drawCard(), drawCard()];
    dealerHand = [drawCard(), drawCard()];
    inRound = true;
    canDouble = true;

    renderHands(false);
    updateButtons();

    if(settleNatural()){
      return;
    }
    setMessage('Hit, Stand, or Double.');
  }

  function onHit(){
    if(!inRound) return;
    playerHand.push(drawCard());
    canDouble = false;
    renderHands(false);
    const pTotal = bjHandTotal(playerHand);
    if(pTotal > 21){
      renderHands(true);
      setMessage('You busted.');
      endRoundNormal();
    }else{
      setMessage('You drew a card.');
      updateButtons();
    }
  }

  function onStand(){
    if(!inRound) return;
    canDouble = false;
    dealerPlay();
    endRoundNormal();
  }

  function onDouble(){
    if(!inRound || !canDouble) return;
    if(bank < bet){
      setMessage('Not enough bank to double.');
      return;
    }
    bank -= bet;
    bet *= 2;
    bankEl.textContent = bank;
    canDouble = false;

    playerHand.push(drawCard());
    renderHands(false);
    const pTotal = bjHandTotal(playerHand);
    if(pTotal > 21){
      renderHands(true);
      setMessage('You busted on double.');
      endRoundNormal();
    }else{
      dealerPlay();
      endRoundNormal();
    }
  }

  dealBtn.addEventListener('click', startDeal);
  hitBtn.addEventListener('click', onHit);
  standBtn.addEventListener('click', onStand);
  doubleBtn.addEventListener('click', onDouble);

  updateButtons();
})();

/* ========= TEXAS HOLD'EM (SHOWDOWN) ========= */
(function setupHoldem(){
  const oppSel = document.getElementById('hOppCount');
  const newHandBtn = document.getElementById('hNewHandBtn');
  const boardEl = document.getElementById('hBoard');
  const playersEl = document.getElementById('hPlayers');
  const statusEl = document.getElementById('hStatus');

  let hPlayers = [];
  let hBoardCards = [];
  let hDeck = [];

  const RANK_VALUE = {
    "2":2,"3":3,"4":4,"5":5,"6":6,"7":7,
    "8":8,"9":9,"10":10,"J":11,"Q":12,"K":13,"A":14
  };

  function makeHoldemDeck(){
    const d = [];
    for(const s of SUITS){
      for(const r of RANKS){
        if(r === "A" || r === "K" || r === "Q" || r === "J" || r === "10" ||
           r === "9" || r === "8" || r === "7" || r === "6" || r === "5" ||
           r === "4" || r === "3" || r === "2"){
          d.push({rank:r, suit:s});
        }
      }
    }
    return d;
  }

  function drawHoldem(){
    if(hDeck.length === 0){
      hDeck = makeHoldemDeck();
      shuffle(hDeck);
    }
    return hDeck.pop();
  }

  function evalHand7(cards){
    const counts = {};
    const suits = {};
    for(const c of cards){
      const rv = RANK_VALUE[c.rank];
      counts[rv] = (counts[rv] || 0) + 1;
      suits[c.suit] = (suits[c.suit] || 0) + 1;
    }
    const uniqueRanks = Object.keys(counts).map(Number).sort((a,b)=>b-a);

    let flushSuit = null;
    for(const s of SUITS){
      if((suits[s] || 0) >= 5){
        flushSuit = s;
        break;
      }
    }
    let flushRanks = [];
    if(flushSuit){
      flushRanks = cards
        .filter(c => c.suit === flushSuit)
        .map(c => RANK_VALUE[c.rank])
        .sort((a,b)=>b-a);
    }

    function bestStraight(vals){
      if(vals.length < 5) return null;
      const v = [...new Set(vals)];
      if(v.includes(14)) v.push(1);
      let best = null;
      for(let i=0;i<v.length;i++){
        let run = [v[i]];
        for(let j=i+1;j<v.length && run.length<5;j++){
          if(v[j] === run[run.length-1] - 1){
            run.push(v[j]);
          }else if(v[j] === run[run.length-1]){
            continue;
          }else{
            break;
          }
        }
        if(run.length >= 5){
          let top = run[0];
          if(run[0] === 14 && run[1] === 5) top = 5;
          if(!best || top > best) best = top;
        }
      }
      return best;
    }

    const straightHigh = bestStraight(uniqueRanks);
    let sfHigh = null;
    if(flushRanks.length >= 5){
      sfHigh = bestStraight(flushRanks);
    }

    const fours = [], threes = [], pairs = [];
    for(const rv of uniqueRanks){
      const c = counts[rv];
      if(c === 4) fours.push(rv);
      else if(c === 3) threes.push(rv);
      else if(c === 2) pairs.push(rv);
    }

    let category = 0;
    let scoreParts = [0,0,0,0,0];
    let label = "High Card";

    if(sfHigh){
      category = 8;
      label = sfHigh === 14 ? "Royal Flush" : "Straight Flush";
      scoreParts[0] = sfHigh;
    }else if(fours.length){
      category = 7;
      label = "Four of a Kind";
      scoreParts[0] = fours[0];
      const kicker = uniqueRanks.find(v => v !== fours[0]) || 0;
      scoreParts[1] = kicker;
    }else if(threes.length && (pairs.length || threes.length > 1)){
      category = 6;
      label = "Full House";
      const three = threes[0];
      const pair = (threes.length > 1 ? threes[1] : pairs[0]);
      scoreParts[0] = three;
      scoreParts[1] = pair;
    }else if(flushSuit){
      category = 5;
      label = "Flush";
      for(let i=0;i<5;i++) scoreParts[i] = flushRanks[i] || 0;
    }else if(straightHigh){
      category = 4;
      label = "Straight";
      scoreParts[0] = straightHigh;
    }else if(threes.length){
      category = 3;
      label = "Three of a Kind";
      scoreParts[0] = threes[0];
      const kickers = uniqueRanks.filter(v=>v!==threes[0]).slice(0,2);
      scoreParts[1] = kickers[0] || 0;
      scoreParts[2] = kickers[1] || 0;
    }else if(pairs.length >= 2){
      category = 2;
      label = "Two Pair";
      const [hi,lo] = pairs.slice(0,2);
      scoreParts[0] = hi;
      scoreParts[1] = lo;
      const kicker = uniqueRanks.find(v => v!==hi && v!==lo) || 0;
      scoreParts[2] = kicker;
    }else if(pairs.length === 1){
      category = 1;
      label = "One Pair";
      const p = pairs[0];
      scoreParts[0] = p;
      const kickers = uniqueRanks.filter(v => v!==p).slice(0,3);
      for(let i=0;i<3;i++) scoreParts[1+i] = kickers[i] || 0;
    }else{
      category = 0;
      label = "High Card";
      for(let i=0;i<5;i++){
        scoreParts[i] = uniqueRanks[i] || 0;
      }
    }

    let score = category * 1e10;
    for(let i=0;i<5;i++){
      score += scoreParts[i] * Math.pow(100, 4-i);
    }
    return { score, label, category };
  }

  function renderBoard(){
    boardEl.innerHTML = '';
    if(hBoardCards.length === 0){
      const span = document.createElement('span');
      span.textContent = 'No board yet.';
      span.style.opacity = '0.8';
      boardEl.appendChild(span);
      return;
    }
    hBoardCards.forEach(c => {
      boardEl.appendChild(createCardEl(c, { small:false }));
    });
  }

  function renderPlayers(){
    playersEl.innerHTML = '';
    hPlayers.forEach(p => {
      const seat = document.createElement('div');
      seat.className = 'h-seat' + (p.isHuman ? ' you' : '');
      const head = document.createElement('div');
      head.className = 'h-head';
      const nameEl = document.createElement('div');
      nameEl.className = 'h-name';
      nameEl.textContent = p.name;
      head.appendChild(nameEl);
      const tag = document.createElement('div');
      tag.className = 'h-tag' + (p.winner ? ' winner' : '');
      tag.textContent = p.winner ? 'Winner' : (p.isHuman ? 'You' : 'CPU');
      head.appendChild(tag);
      seat.appendChild(head);

      const row = document.createElement('div');
      row.className = 'h-handrow';
      const cardsWrap = document.createElement('div');
      cardsWrap.className = 'h-cards';
      p.hand.forEach(c => {
        cardsWrap.appendChild(createCardEl(c, { small:true }));
      });
      row.appendChild(cardsWrap);
      const note = document.createElement('div');
      note.className = 'h-note';
      note.textContent = p.bestLabel || '';
      row.appendChild(note);
      seat.appendChild(row);

      playersEl.appendChild(seat);
    });
  }

  function dealHand(){
    const oppCount = parseInt(oppSel.value,10) || 2;
    hDeck = makeHoldemDeck();
    shuffle(hDeck);
    hBoardCards = [];
    hPlayers = [];

    hPlayers.push({
      name:"You",
      isHuman:true,
      hand:[drawHoldem(), drawHoldem()],
      bestLabel:"",
      score:0,
      winner:false
    });
    for(let i=1;i<=oppCount;i++){
      hPlayers.push({
        name:"CPU "+i,
        isHuman:false,
        hand:[drawHoldem(), drawHoldem()],
        bestLabel:"",
        score:0,
        winner:false
      });
    }

    hBoardCards.push(drawHoldem(), drawHoldem(), drawHoldem(), drawHoldem(), drawHoldem());

    let bestScore = -1;
    hPlayers.forEach(p => {
      const combo = [...p.hand, ...hBoardCards];
      const res = evalHand7(combo);
      p.score = res.score;
      p.bestLabel = res.label;
      if(res.score > bestScore) bestScore = res.score;
    });

    const winners = hPlayers.filter(p => p.score === bestScore);
    winners.forEach(p => p.winner = true);

    renderBoard();
    renderPlayers();

    if(winners.length === 1){
      const w = winners[0];
      const who = w.isHuman ? "You" : w.name;
      statusEl.textContent = `${who} win(s) with ${w.bestLabel}.`;
    }else{
      const names = winners.map(w => w.isHuman ? "You" : w.name).join(", ");
      statusEl.textContent = `Split pot between ${names} with ${winners[0].bestLabel}.`;
    }
  }

  newHandBtn.addEventListener('click', dealHand);
})();

/* ========= SNAKE ========= */
(function setupSnake(){
  const canvas  = document.getElementById('snakeCanvas');
  const ctx     = canvas.getContext('2d');
  const scoreEl = document.getElementById('snakeScore');
  const screen  = document.getElementById('snakeScreen');
  const lbList  = document.getElementById('snakeLeaderboardList');

  const cell = 10;
  const rows = canvas.height / cell;
  const cols = canvas.width  / cell;

  const LB_KEY = 'snakeHighScores_v1';

  let snake, dir, apple, score, speed, interval, pendingDir;

  function loadHighScores(){
    try{
      const raw = localStorage.getItem(LB_KEY);
      if(!raw) return [];
      const parsed = JSON.parse(raw);
      return Array.isArray(parsed) ? parsed : [];
    }catch(e){
      return [];
    }
  }

  function saveHighScores(list){
    try{
      localStorage.setItem(LB_KEY, JSON.stringify(list));
    }catch(e){
      // ignore
    }
  }

  function updateLeaderboard(){
    const scores = loadHighScores();
    lbList.innerHTML = '';

    if(!scores.length){
      const li = document.createElement('li');
      li.textContent = 'No scores yet. Go eat some pixels.';
      lbList.appendChild(li);
      return;
    }

    scores.forEach((entry, idx) => {
      const li = document.createElement('li');
      const date = entry.when ? new Date(entry.when) : null;
      let dateStr = '';
      if(date && !isNaN(date)){
        dateStr = ' â€” ' + date.toLocaleDateString();
      }
      li.textContent = `${idx+1}. ${entry.score}${dateStr}`;
      lbList.appendChild(li);
    });
  }

  function recordScore(value){
    if(value <= 0) return;
    let list = loadHighScores();
    list.push({ score:value, when:new Date().toISOString() });
    list.sort((a,b)=>b.score - a.score);
    list = list.slice(0,10);
    saveHighScores(list);
  }

  function randomApple(){
    let a;
    do{
      a = {
        x: Math.floor(Math.random()*cols),
        y: Math.floor(Math.random()*rows)
      };
    }while(snake && snake.some(s=>s.x===a.x && s.y===a.y));
    return a;
  }

  function drawBoard(){
    ctx.fillStyle = '#5a7751';
    ctx.fillRect(0,0,canvas.width,canvas.height);
  }

  function drawCell(x,y,color){
    ctx.fillStyle = color;
    ctx.fillRect(x*cell, y*cell, cell-1, cell-1);
  }

  function loop(){
    if(pendingDir){
      if(!(pendingDir.x === -dir.x && pendingDir.y === -dir.y)){
        dir = pendingDir;
      }
      pendingDir = null;
    }

    const head = {
      x: (snake[0].x + dir.x + cols) % cols,
      y: (snake[0].y + dir.y + rows) % rows
    };

    if(snake.some(s => s.x === head.x && s.y === head.y)){
      gameOver();
      return;
    }

    snake.unshift(head);

    if(head.x === apple.x && head.y === apple.y){
      score++;
      scoreEl.textContent = score;
      apple = randomApple();
      if(speed > 60){
        clearInterval(interval);
        speed -= 5;
        interval = setInterval(loop, speed);
      }
    }else{
      snake.pop();
    }

    drawBoard();
    drawCell(apple.x, apple.y, '#aaffaa');
    for(const seg of snake){
      drawCell(seg.x, seg.y, '#003300');
    }
  }

  function drawGameOverOverlay(){
    ctx.fillStyle = '#4a5f4a';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = '#aaffaa';
    ctx.font = "16px 'Courier New'";
    ctx.fillText('GAME OVER', 65, 150);
    ctx.fillText('Tap or Enter', 65, 170);
  }

  function gameOver(){
    clearInterval(interval);
    recordScore(score);
    updateLeaderboard();
    drawGameOverOverlay();
    document.addEventListener('keydown', restartOnEnter, { once:true });
    screen.addEventListener('touchstart', restartOnTouch, { once:true });
  }

  function restartOnEnter(e){
    if(e.key === 'Enter') start();
  }
  function restartOnTouch(){
    start();
  }

  function start(){
    snake = [{ x: Math.floor(cols/2), y: Math.floor(rows/2) }];
    dir   = { x:1, y:0 };
    apple = randomApple();
    score = 0;
    scoreEl.textContent = 0;
    speed = 150;
    pendingDir = null;

    drawBoard();
    clearInterval(interval);
    interval = setInterval(loop, speed);
  }

  document.addEventListener('keydown', e => {
    switch(e.key){
      case 'ArrowUp':
      case 'w':
      case 'W':
        if(dir.y === 0) pendingDir = { x:0, y:-1 };
        break;
      case 'ArrowDown':
      case 's':
      case 'S':
        if(dir.y === 0) pendingDir = { x:0, y: 1 };
        break;
      case 'ArrowLeft':
      case 'a':
      case 'A':
        if(dir.x === 0) pendingDir = { x:-1, y:0 };
        break;
      case 'ArrowRight':
      case 'd':
      case 'D':
        if(dir.x === 0) pendingDir = { x: 1, y:0 };
        break;
      default:
        break;
    }
  });

  screen.addEventListener('touchstart', e => {
    const r = screen.getBoundingClientRect();
    const t = e.touches[0];
    const x = t.clientX - r.left;
    const y = t.clientY - r.top;
    const w = r.width;
    const h = r.height;
    const cx = w/2;
    const cy = h/2;
    const dx = x - cx;
    const dy = y - cy;
    const ax = Math.abs(dx);
    const ay = Math.abs(dy);

    let ndir = { ...dir };
    if(ax > ay){
      ndir = dx < 0 ? {x:-1,y:0} : {x:1,y:0};
    }else{
      ndir = dy < 0 ? {x:0,y:-1} : {x:0,y:1};
    }
    if(!(ndir.x === -dir.x && ndir.y === -dir.y) && pendingDir === null){
      pendingDir = ndir;
    }
  });

  updateLeaderboard();
  start();
})();

/* ========= MINESWEEPER ========= */
(function setupMinesweeper(){
  const boardEl = document.getElementById('msBoard');
  const mineCountEl = document.getElementById('msMineCount');
  const timerEl = document.getElementById('msTimer');
  const resetBtn = document.getElementById('msReset');
  const smiley = document.getElementById('msSmiley');
  const diffSel = document.getElementById('msDifficulty');
  const statusEl = document.getElementById('msStatus');

  let R=9, C=9, M=10;
  let grid = [];
  let firstClick = true;
  let minesLeft = M;
  let timer = 0, timerHandle = null, running = false, alive = true, revealedCount = 0;

  function pad3(n){ n=Math.max(0,Math.min(999,n)); return String(n).padStart(3,'0'); }

  function neighbors(r,c){
    const out=[];
    for(let dr=-1;dr<=1;dr++){
      for(let dc=-1;dc<=1;dc++){
        if(dr===0 && dc===0) continue;
        const nr=r+dr, nc=c+dc;
        if(nr>=0 && nr<R && nc>=0 && nc<C) out.push(grid[nr][nc]);
      }
    }
    return out;
  }

  function setDifficulty(spec){
    const [rs, cs, ms] = spec.split('x').map(Number);
    R=rs; C=cs; M=ms;
  }

  function newGrid(){
    boardEl.style.setProperty('--rows', R);
    boardEl.style.setProperty('--cols', C);
    boardEl.innerHTML = '';
    grid = [];
    for(let r=0;r<R;r++){
      const row=[];
      for(let c=0;c<C;c++){
        const cell = {
          r, c, mine:false, adj:0, revealed:false, flagged:false,
          el: document.createElement('div')
        };
        cell.el.className = 'cell';
        cell.el.dataset.r = r;
        cell.el.dataset.c = c;
        cell.el.addEventListener('mousedown', onMouseDown);
        cell.el.addEventListener('contextmenu', e => e.preventDefault());
        cell.el.addEventListener('dblclick', onChord);
        boardEl.appendChild(cell.el);
        row.push(cell);
      }
      grid.push(row);
    }
  }

  function reset(){
    firstClick = true; running = false; alive = true; revealedCount = 0;
    clearInterval(timerHandle); timerHandle=null; timer=0; timerEl.textContent=pad3(0);
    minesLeft = M; mineCountEl.textContent = pad3(minesLeft);
    smiley.textContent = 'ðŸ™‚';
    statusEl.textContent = '';
    newGrid();
  }

  function startTimer(){
    if(running) return;
    running = true;
    timerHandle = setInterval(()=>{
      timer++; timerEl.textContent = pad3(timer);
      if(timer>=999){ clearInterval(timerHandle); timerHandle=null; running=false; }
    }, 1000);
  }

  function placeMines(safeR, safeC){
    const forbid = new Set([`${safeR},${safeC}`]);
    neighbors(safeR,safeC).forEach(n=>forbid.add(`${n.r},${n.c}`));
    let placed = 0;
    while(placed < M){
      const r=Math.floor(Math.random()*R), c=Math.floor(Math.random()*C);
      const key = `${r},${c}`;
      if(forbid.has(key) || grid[r][c].mine) continue;
      grid[r][c].mine = true; placed++;
    }
    for(let r=0;r<R;r++){
      for(let c=0;c<C;c++){
        if(grid[r][c].mine) continue;
        grid[r][c].adj = neighbors(r,c).reduce((n,cc)=>n+(cc.mine?1:0),0);
      }
    }
  }

  function drawCell(cell){
    const el = cell.el;
    el.className = 'cell' + (cell.revealed ? ' revealed' : '');
    el.textContent = '';
    if(cell.revealed){
      if(cell.mine){
        el.classList.add('mine');
        el.textContent = 'ðŸ’£';
      }else if(cell.adj>0){
        el.classList.add('n'+cell.adj);
        el.textContent = cell.adj;
      }
    }else if(cell.flagged){
      el.classList.add('flagged');
      el.textContent = 'âš‘';
    }
  }

  function drawAll(){
    for(let r=0;r<R;r++){
      for(let c=0;c<C;c++){
        drawCell(grid[r][c]);
      }
    }
  }

  function reveal(cell){
    if(cell.revealed || cell.flagged || !alive) return;
    cell.revealed = true; revealedCount++;
    drawCell(cell);
    if(cell.mine){
      lose(cell);
      return;
    }
    if(cell.adj===0){
      neighbors(cell.r,cell.c).forEach(reveal);
    }
  }

  function toggleFlag(cell){
    if(cell.revealed || !alive) return;
    cell.flagged = !cell.flagged;
    minesLeft += cell.flagged ? -1 : 1;
    mineCountEl.textContent = pad3(minesLeft);
    drawCell(cell);
  }

  function checkWin(){
    if(!alive) return;
    const needed = R*C - M;
    if(revealedCount >= needed){
      alive=false; running=false; clearInterval(timerHandle);
      smiley.textContent = 'ðŸ˜Ž';
      statusEl.textContent = 'You win!';
      for(let r=0;r<R;r++){
        for(let c=0;c<C;c++){
          const cell=grid[r][c];
          if(cell.mine && !cell.flagged){ cell.flagged=true; drawCell(cell); }
        }
      }
    }
  }

  function lose(hitCell){
    alive=false; running=false; clearInterval(timerHandle);
    smiley.textContent = 'ðŸ˜µ';
    statusEl.textContent = 'Boom! Game over.';
    for(let r=0;r<R;r++){
      for(let c=0;c<C;c++){
        const cell = grid[r][c];
        if(cell.mine){ cell.revealed = true; }
        if(cell===hitCell){ cell.el.style.background = '#ff9ea3'; }
        drawCell(cell);
      }
    }
  }

  function chord(cell){
    if(!cell.revealed || cell.adj===0) return;
    const adj = neighbors(cell.r,cell.c);
    const flagged = adj.filter(n=>n.flagged).length;
    if(flagged === cell.adj){
      adj.forEach(n=>{ if(!n.flagged && !n.revealed) reveal(n); });
    }
  }

  function onMouseDown(e){
    e.preventDefault();
    if(!alive) return;
    const r = +this.dataset.r;
    const c = +this.dataset.c;
    const cell = grid[r][c];

    if(firstClick){
      placeMines(r,c);
      firstClick = false;
      startTimer();
    }

    if(e.button === 2){
      toggleFlag(cell);
      checkWin();
      return;
    }
    if(e.button === 0){
      if(cell.flagged) return;
      reveal(cell);
      drawCell(cell);
      checkWin();
    }
  }

  function onChord(e){
    e.preventDefault();
    if(!alive) return;
    const r = +this.dataset.r;
    const c = +this.dataset.c;
    const cell = grid[r][c];
    chord(cell);
    checkWin();
  }

  resetBtn.addEventListener('click', reset);
  diffSel.addEventListener('change', ()=>{
    setDifficulty(diffSel.value);
    reset();
  });

  setDifficulty(diffSel.value);
  reset();
})();

/* ========= BACCARAT (SIMPLE) ========= */
(function setupBaccarat(){
  const bankEl = document.getElementById('bacBank');
  const betInput = document.getElementById('bacBet');
  const dealBtn = document.getElementById('bacDealBtn');
  const msgEl = document.getElementById('bacMessage');
  const playerRow = document.getElementById('bacPlayerCards');
  const bankerRow = document.getElementById('bacBankerCards');
  const pTotalEl = document.getElementById('bacPlayerTotal');
  const bTotalEl = document.getElementById('bacBankerTotal');

  let bank = 1000;
  let deck = [];

  function getSide(){
    const radios = document.querySelectorAll('input[name="bacSide"]');
    for(const r of radios){
      if(r.checked) return r.value;
    }
    return 'player';
  }

  function bacCardValue(rank){
    if(rank === "A") return 1;
    if(rank === "K" || rank === "Q" || rank === "J" || rank === "10") return 0;
    return parseInt(rank,10);
  }

  function bacTotal(cards){
    let t = 0;
    for(const c of cards){
      t += bacCardValue(c.rank);
    }
    return t % 10;
  }

  function ensureDeck(){
    if(deck.length < 10){
      deck = [];
      for(const s of SUITS){
        for(const r of RANKS){
          deck.push({rank:r, suit:s});
        }
      }
      shuffle(deck);
    }
  }

  function drawCard(){
    ensureDeck();
    return deck.pop();
  }

  function clearTable(){
    playerRow.innerHTML = '';
    bankerRow.innerHTML = '';
    pTotalEl.textContent = '';
    bTotalEl.textContent = '';
  }

  function setMsg(t){
    msgEl.textContent = t || '';
  }

  function onDeal(){
    setMsg('');
    clearTable();
    const rawBet = parseInt(betInput.value, 10) || 0;
    if(rawBet <= 0){
      setMsg('Bet must be > 0.');
      return;
    }
    if(rawBet > bank){
      setMsg('Bet exceeds bank.');
      return;
    }
    const side = getSide();

    bank -= rawBet;
    bankEl.textContent = bank;

    const player = [drawCard(), drawCard()];
    const banker = [drawCard(), drawCard()];

    player.forEach(c => playerRow.appendChild(createCardEl(c,{small:false})));
    banker.forEach(c => bankerRow.appendChild(createCardEl(c,{small:false})));

    const pt = bacTotal(player);
    const bt = bacTotal(banker);
    pTotalEl.textContent = pt;
    bTotalEl.textContent = bt;

    let winner = 'tie';
    if(pt > bt) winner = 'player';
    else if(bt > pt) winner = 'banker';

    let payout = 0;
    if(winner === side){
      if(winner === 'tie'){
        payout = rawBet * 8;
        bank += rawBet + payout;
        setMsg(`Tie wins. Payout $${payout}.`);
      }else if(winner === 'player'){
        payout = rawBet;
        bank += rawBet + payout;
        setMsg(`Player wins. Payout $${payout}.`);
      }else{
        payout = Math.floor(rawBet * 0.95);
        bank += rawBet + payout;
        setMsg(`Banker wins. Payout $${payout} (5% commission).`);
      }
    }else if(side === 'tie' && winner !== 'tie'){
      setMsg(`No tie. You lose $${rawBet}.`);
    }else{
      setMsg(`${winner.charAt(0).toUpperCase()+winner.slice(1)} wins. You lose $${rawBet}.`);
    }
    bankEl.textContent = bank;
  }

  dealBtn.addEventListener('click', onDeal);
  bankEl.textContent = bank;
})();
</script>
</body>
</html>
